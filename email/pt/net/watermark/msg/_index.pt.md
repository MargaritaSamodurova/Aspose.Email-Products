---
title: Documento MSG com marca d'água via .NET
weight: 1180
url: /pt/net/watermark/msg/
description: Código-fonte C# para adicionar ou remover marca d'água ao arquivo MSG em plataformas .NET Framework, .NET Core e Xamarin.
---

{{< blocks/products/pf/main-wrap-class isAutogenPage="true">}}
{{< blocks/products/pf/i18n/upper-banner h1="Adicionar marca d'água de texto ao MSG via C #" h2="Crie seus próprios aplicativos .NET para criar marcas d'água em arquivos MSG usando APIs do lado do servidor." logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/email/aspose_email-for-net.svg" sourceAdditionalConversionTag="" additionalConversionTag="MSG" pfName="Aspose.Email" subTitlepfName="para .NET" downloadUrl="" fileiconsmall1="PPTX" fileiconsmall2="DOCX" fileiconsmall3="XLSX" fileiconsmall4="PDF" fileiconsmall5=" ODP " >}}

{{< blocks/products/pf/main-container pfName="Aspose.Email " subTitlepfName="para .NET" >}}
{{< blocks/products/pf/i18n/sub-menu autoGeneratedVersion="true" logoImageSrc="https://www.aspose.cloud/templates/aspose/img/products/email/aspose_email-for-net.svg" apiHomeLink="" codeSamplesLink="https://github.com/aspose-email" liveDemosLink="https://products.aspose.app/email/family" docsLink="https://docs.aspose.com/email/net" installationsDocsLink="https://docs.aspose.com/email/net" nugetLink="https://www.nuget.org/packages/aspose.email" nugetPackageName="" downloadAsLink="https://releases.aspose.com/email/net/" learnAsLink="https://docs.aspose.com/email/net" apiReference="" mavenRepoLink="" >}}

{{% blocks/products/pf/agp/content h2="Como marcar um arquivo MSG com marca d'água usando C#" %}}

 Para marcar o arquivo MSG com marca d'água, usaremos
 [Aspose.Email para .NET](https://products.aspose.com/email/net/)
 API que é uma API de manipulação de documentos rica em recursos, poderosa e fácil de usar para a plataforma C#. Abrir
 [NuGet](https://www.nuget.org/packages/aspose.email)
 gerenciador de pacotes, procure por
 **Aspose.Email**
 e instale. Você também pode usar o seguinte comando no console do gerenciador de pacotes.

{{% blocks/products/pf/agp/code-block title="Command" offSpacer="true" %}}

```cs

PM> Install-Package Aspose.Email

```

{{% /blocks/products/pf/agp/code-block %}}

{{% /blocks/products/pf/agp/content %}}

{{< blocks/products/pf/agp/feature-section isGrey="true" >}}

{{% blocks/products/pf/agp/feature-section-col title="Etapas para adicionar marca d'água ao MSG via C #" %}}

{{% blocks/products/pf/agp/text %}}

 você precisa do
 [aspose.email.dll](https://releases.aspose.com/email/net/)
 para tentar o seguinte fluxo de trabalho em seu próprio ambiente.

{{% /blocks/products/pf/agp/text %}}

+  Carregar o corpo HTML do arquivo de mensagem de e-mail
+  Carregar anexo e definir seu conteúdo
+  Defina o conteúdo do corpo, se houver
+  Salvar arquivo de e-mail no disco

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/feature-section-col title="Requisitos de sistema" %}}

{{% blocks/products/pf/agp/text %}}

 Aspose.Email para .NET é compatível com todos os principais sistemas operacionais. Apenas certifique-se de ter os seguintes pré-requisitos.

{{% /blocks/products/pf/agp/text %}}

-  Microsoft Windows ou um sistema operacional compatível com .NET Framework, .NET Core e plataformas Xamarin.
-  Ambiente de desenvolvimento como o Microsoft Visual Studio.
-  Aspose.Email para .NET referenciado em seu projeto.

{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/code-block title="Adicionar marca d'água ao MSG - C#" offSpacer="" %}}

```cs

mail.Attachments.Add("watermark", imageBytes);

var html = mail.BodyHtml;
var htmlDocument = new Aspose.Html.HTMLDocument(mail.BodyHtml, "");

var attachment = mail.Attachments.Find(x => x.LongFileName == "watermark");
attachment.SetContentId("watermark");

var bodyHtml = htmlDocument.Body.InnerHTML;

var watermarkHtml = $@"watermarkHtml";

htmlDocument.Body.InnerHTML = watermarkHtml;

var folderPath = Path.Combine(Config.Configuration.OutputDirectory, Guid.NewGuid().ToString());
var filePath = Path.Combine(folderPath, "Merged.html");

htmlDocument.Save(filePath);

var content = System.IO.File.ReadAllText(filePath);

Directory.Delete(folderPath, true);

mail.SetBodyContent(content, BodyContentType.Html); 

```

{{% /blocks/products/pf/agp/code-block %}}

{{< /blocks/products/pf/agp/feature-section >}}

    {{< blocks/products/pf/agp/faq-item question="" answer="" >}}


<!-- aboutfile Starts -->

    {{% blocks/products/pf/agp/content h2="Sobre Aspose.Email para API .NET" %}}

 Aspose.Email é uma solução de análise de formatos do Microsoft Outlook e Thunderbird. Pode-se facilmente criar, manipular, converter e-mail e formatos de armazenamento, como MSG, EMLX, EML e MHT. O manuseio de anexos de e-mail, personalização de cabeçalhos de mensagens e implementação de diferentes protocolos de rede como POP3, IMAP e SMTP para enviar e receber e-mails é muito mais fácil. É uma API independente e não requer o Microsoft Outlook ou qualquer outra instalação de software.



    {{% /blocks/products/pf/agp/content %}}

    {{< blocks/products/pf/agp/about-file-section >}}

        {{< blocks/products/pf/agp/demobox sectionTitle="MSG de marca d'água via aplicativo on-line" sectionDescription="Adicione marca d'água a documentos MSG visitando nosso [Site de Demonstrações ao Vivo](https://products.aspose.app/email/watermark). A demonstração ao vivo tem os seguintes benefícios" >}}
            {{< blocks/products/pf/agp/democard icon="fa-cogs" text=" Não há necessidade de baixar ou configurar nada" >}}
            {{< blocks/products/pf/agp/democard icon="fa-edit" text=" Não há necessidade de escrever nenhum código" >}}
            {{< blocks/products/pf/agp/democard icon="fa-file-text" text="Basta carregar seu arquivo MSG, definir sua marca d'água e clicar no botão \"Adicionar\"" >}}
            {{< blocks/products/pf/agp/democard icon="fa-download" text=" Obtenha instantaneamente o link de download do arquivo resultante" >}}

        {{< blocks/products/pf/agp/about-file-text fileFormat="MSG" readMoreLink="https://docs.fileformat.com/email/msg/" >}}
MSG é um formato de arquivo usado pelo Microsoft Outlook e Exchange para armazenar mensagens de e-mail, contatos, compromissos ou outras tarefas. Essas mensagens podem conter um ou mais campos de e-mail, com remetente, destinatário, assunto, data e corpo da mensagem, ou informações de contato, detalhes de compromissos e uma ou mais especificações de tarefas. As propriedades que constituem o objeto Message, inclusive, também fazem parte do arquivo MSG. O arquivo MSG possui cabeçalhos, corpo da mensagem principal e hiperlinks como texto ASCII simples. Os arquivos MSG também são adequados aos programas que precisam da MAPI (Messaging Applications Programming Interface) da Microsoft.

        {{< /blocks/products/pf/agp/about-file-text >}}

    {{< /blocks/products/pf/agp/about-file-section >}}

<!-- aboutfile Ends -->

{{< blocks/products/pf/agp/other-supported-section title="Outros formatos de marca d'água suportados" subTitle="Usando C #, pode-se facilmente marcar diferentes formatos, incluindo." >}}

{{< blocks/products/pf/agp/other-supported-section-item href="https://products.aspose.com/email/net/watermark/eml/" name="EML" description="Mensagens de e-mail do Outlook" >}}

{{< /blocks/products/pf/agp/other-supported-section >}}

{{< /blocks/products/pf/main-container >}}
   
{{< /blocks/products/pf/main-wrap-class >}}